#!/bin/bash

# è®¾ç½®ä»£ç†ï¼ˆæ ¹æ®ç”¨æˆ·è§„åˆ™ï¼‰
export https_proxy=http://127.0.0.1:7890
export http_proxy=http://127.0.0.1:7890
export all_proxy=socks5://127.0.0.1:7890

# å®šä¹‰é¢œè‰²è¾“å‡º
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m' # æ— é¢œè‰²

echo "ğŸš€ å¼€å§‹è¿è¡Œ QuantMesh Market Maker è‡ªåŠ¨åŒ–å•å…ƒæµ‹è¯•..."
echo "--------------------------------------------------"

# æ¸…ç†å¯èƒ½æ®‹ç•™çš„æµ‹è¯•æ•°æ®åº“æ–‡ä»¶
rm -f ./test_quantmesh.db*
rm -f ./storage/test_quantmesh.db*

# è¿è¡Œæ‰€æœ‰å·²å®ç°æµ‹è¯•çš„åŒ…
# -v: æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—
# -count=1: ç¦ç”¨æµ‹è¯•ç¼“å­˜ï¼Œç¡®ä¿æ¯æ¬¡éƒ½æ˜¯çœŸå®è¿è¡Œ
go test -v ./utils/... ./config/... ./storage/... ./position/... ./safety/... ./strategy/...

# æ£€æŸ¥è¿è¡Œç»“æœ
if [ $? -eq 0 ]; then
    echo "--------------------------------------------------"
    echo -e "${GREEN}âœ… æ‰€æœ‰å•å…ƒæµ‹è¯•å‡å·²é€šè¿‡ï¼${NC}"
else
    echo "--------------------------------------------------"
    echo -e "${RED}âŒ éƒ¨åˆ†å•å…ƒæµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ä¸Šæ–¹æ—¥å¿—ã€‚${NC}"
    exit 1
fi

