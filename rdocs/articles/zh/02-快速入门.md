# 快速入门指南

> **版本**: v3.3.2  
> **更新时间**: 2025-01-27

---

## 目录

1. [环境要求](#环境要求)
2. [安装步骤](#安装步骤)
3. [配置文件说明](#配置文件说明)
4. [启动运行](#启动运行)
5. [首次使用建议](#首次使用建议)
6. [Web 界面访问](#web-界面访问)

---

## 环境要求

### 必需环境

- **Go 语言**: 1.21 或更高版本
- **操作系统**: Linux、macOS 或 Windows
- **网络环境**: 能够访问交易所 API（可能需要代理）

### 可选环境

- **Node.js**: 16+（如需构建前端界面）
- **yarn 或 npm**: 前端依赖管理工具

### 检查环境

```bash
# 检查 Go 版本
go version

# 应该显示类似：go version go1.21.x linux/amd64
```

如果未安装 Go，请访问 [Go 官网](https://golang.org/dl/) 下载安装。

---

## 安装步骤

### 1. 克隆仓库

```bash
git clone https://github.com/dennisyang1986/quantmesh_market_maker.git
cd quantmesh_market_maker
```

### 2. 安装依赖

```bash
go mod download
```

### 3. 复制配置文件

```bash
cp config.example.yaml config.yaml
```

### 4. 配置 API 密钥

编辑 `config.yaml` 文件，填入你的交易所 API 密钥：

```yaml
app:
  current_exchange: "binance"  # 选择交易所

exchanges:
  binance:
    api_key: "YOUR_API_KEY"
    secret_key: "YOUR_API_SECRET"
    fee_rate: 0.0002
    testnet: false  # 首次使用建议设置为 true（测试网）
```

**重要提示：**
- 首次使用建议在测试网（testnet）上测试
- API 密钥需要具有交易权限（但建议只开启合约交易权限，不要开启提币权限）
- 不同交易所的配置项可能不同（如 Bitget 需要 passphrase）

### 5. 配置交易参数

```yaml
trading:
  symbol: "ETHUSDT"       # 交易对
  price_interval: 2       # 网格间距（美元）
  order_quantity: 30      # 每格投入金额（USDT）
  buy_window_size: 10     # 买单挂单数量
  sell_window_size: 10    # 卖单挂单数量
```

**参数说明：**
- `price_interval`: 价格间隔，建议根据币种波动性设置（ETH 建议 1-2 美元）
- `order_quantity`: 每单投入金额，建议根据资金量设置（建议 20-50 USDT）
- `buy_window_size`: 下方买单数量，建议 8-20
- `sell_window_size`: 上方卖单数量，建议 8-20

---

## 配置文件说明

### 基本配置结构

```yaml
# 应用配置
app:
  current_exchange: "binance"  # 当前使用的交易所

# 交易所配置
exchanges:
  binance:
    api_key: "YOUR_API_KEY"
    secret_key: "YOUR_API_SECRET"
    fee_rate: 0.0002
    testnet: false

# 交易配置
trading:
  symbol: "ETHUSDT"
  price_interval: 2
  order_quantity: 30
  buy_window_size: 10
  sell_window_size: 10

# 系统配置
system:
  log_level: "INFO"
  timezone: "Asia/Shanghai"
  cancel_on_exit: true

# 风控配置
risk_control:
  enabled: true
  monitor_symbols: ["BTCUSDT", "ETHUSDT"]
  volume_multiplier: 3.0
```

### 多交易对配置（推荐）

系统支持同时交易多个交易对：

```yaml
trading:
  symbols:
    - exchange: "binance"
      symbol: "ETHUSDT"
      price_interval: 2
      order_quantity: 30
      buy_window_size: 10
      sell_window_size: 10
    - exchange: "bitget"
      symbol: "BTCUSDT"
      price_interval: 10
      order_quantity: 50
      buy_window_size: 8
      sell_window_size: 8
```

### 配置参数详解

#### 交易参数

| 参数 | 说明 | 建议值 |
|------|------|--------|
| `price_interval` | 价格间隔（美元） | ETH: 1-2, BTC: 5-10 |
| `order_quantity` | 每单投入金额（USDT） | 20-50（根据资金量） |
| `buy_window_size` | 下方买单数量 | 8-20 |
| `sell_window_size` | 上方卖单数量 | 8-20 |
| `min_order_value` | 最小订单价值（USDT） | 20（默认） |

#### 风控参数

| 参数 | 说明 | 建议值 |
|------|------|--------|
| `enabled` | 是否启用风控 | true（强烈建议） |
| `volume_multiplier` | 成交量倍数阈值 | 3.0（默认） |
| `average_window` | 移动平均窗口 | 20（默认） |
| `recovery_threshold` | 恢复交易所需正常币种数 | 3（默认） |

更多配置说明请参考 `config.example.yaml` 文件中的注释。

---

## 启动运行

### 方式一：直接运行（开发环境）

```bash
go run main.go
```

### 方式二：编译后运行（生产环境）

```bash
# 编译
go build -o quantmesh .

# 运行
./quantmesh config.yaml
```

### 方式三：使用启动脚本

```bash
# 使用提供的启动脚本
./start.sh
```

### 检查运行状态

系统启动后，你应该看到类似以下的日志：

```
[INFO] 🚀 QuantMesh 做市商系统启动...
[INFO] 📦 版本号: v3.3.2
[INFO] ✅ 配置加载成功: 交易对数量=1, 当前默认交易所=binance
[INFO] ✅ 使用交易所: Binance
[INFO] 🔗 启动 WebSocket 价格流...
[INFO] 📊 当前价格: 42156.78
[INFO] 🔒 ===== 开始持仓安全性检查 =====
[INFO] ✅ 持仓安全性检查通过：可以安全持有至少 100 仓
[INFO] ✅ [Binance] 订单流已启动
[INFO] 📊 [SuperPositionManager] 初始化成功，锚点价格: 42156.78
[INFO] 🛡️ 启动主动安全风控监控 (周期: 1m, 倍数: 3.0)
[INFO] ✅ 系统启动完成，开始自动交易
```

### 停止系统

按 `Ctrl+C` 优雅退出，系统会：
1. 撤销所有未完成订单（如果 `cancel_on_exit: true`）
2. 停止所有协程
3. 保存数据
4. 关闭连接

---

## 首次使用建议

### 1. 使用测试网

**强烈建议首次使用测试网！**

```yaml
exchanges:
  binance:
    testnet: true  # 使用测试网
```

测试网特点：
- 使用虚拟资金，不会造成真实损失
- 可以熟悉系统操作流程
- 验证配置是否正确
- 测试策略参数是否合理

### 2. 小额资金测试

即使使用实盘，也建议：
- 使用小额资金（如 100-500 USDT）
- 设置较小的 `order_quantity`（如 20-30 USDT）
- 设置较小的 `buy_window_size` 和 `sell_window_size`（如 5-10）

### 3. 监控运行状态

首次运行建议：
- 持续监控日志输出
- 观察订单是否正常下单和成交
- 检查持仓是否正确
- 验证风控是否正常工作

### 4. 逐步增加资金

确认系统运行正常后：
- 逐步增加 `order_quantity`
- 增加 `buy_window_size` 和 `sell_window_size`
- 根据市场情况调整 `price_interval`

### 5. 设置合理的风控参数

```yaml
risk_control:
  enabled: true  # 必须启用
  volume_multiplier: 3.0  # 可根据市场情况调整
  recovery_threshold: 3  # 恢复交易条件
```

---

## Web 界面访问

系统内置 Web 界面，方便监控和管理。

### 启动 Web 服务

在 `config.yaml` 中配置：

```yaml
web:
  enabled: true
  host: "0.0.0.0"  # 监听所有地址
  port: 28888      # 端口号
```

### 访问界面

启动系统后，在浏览器中访问：

```
http://localhost:28888
```

或如果部署在服务器上：

```
http://your-server-ip:28888
```

### Web 界面功能

- 📊 **实时监控**: 查看当前价格、持仓、盈亏
- 📈 **交易记录**: 查看历史交易记录
- ⚙️ **配置管理**: 在线修改配置（需要密码）
- 📋 **日志查看**: 查看系统日志
- 🛡️ **风控状态**: 查看风控触发情况

### 安全设置

首次访问需要设置密码：

1. 访问 Web 界面
2. 按照提示设置管理员密码
3. 后续访问需要输入密码

---

## 常见启动问题

### 问题 1: 配置文件不存在

**错误信息：**
```
❌ 加载配置失败: open config.yaml: no such file or directory
```

**解决方案：**
```bash
cp config.example.yaml config.yaml
# 然后编辑 config.yaml
```

### 问题 2: API 密钥错误

**错误信息：**
```
❌ 交易所认证失败
```

**解决方案：**
1. 检查 API 密钥是否正确
2. 确认 API 密钥具有交易权限
3. 检查 IP 白名单设置（如果设置了）
4. 确认是否使用了测试网（testnet 配置）

### 问题 3: 网络连接问题

**错误信息：**
```
❌ WebSocket 连接失败
```

**解决方案：**
1. 检查网络连接
2. 如果使用代理，设置环境变量：
   ```bash
   export https_proxy=http://127.0.0.1:7890
   export http_proxy=http://127.0.0.1:7890
   ```
3. 检查防火墙设置

### 问题 4: 余额不足

**错误信息：**
```
❌ 持仓安全性检查失败：保证金不足
```

**解决方案：**
1. 增加账户余额
2. 降低 `order_quantity`
3. 降低 `buy_window_size` 和 `sell_window_size`
4. 降低 `position_safety_check` 参数

---

## 下一步

- 📊 [网格交易策略详解](./03-网格交易策略.md) - 深入了解交易策略原理
- 🏦 [支持的交易所](./04-支持的交易所.md) - 查看支持的交易所列表
- 🛡️ [风控系统介绍](./05-风控系统.md) - 了解安全机制
- 💡 [使用场景与案例](./06-使用场景.md) - 查看实际应用场景
- ❓ [常见问题 FAQ](./07-常见问题.md) - 解答常见疑问

---

*如有问题，请查看日志文件或参考常见问题文档。*

