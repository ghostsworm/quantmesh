# 杠杆率配置说明

## 概述

杠杆率（Leverage）是期货交易中的重要参数，它决定了您可以用多少倍的资金进行交易。本系统会检查您的账户杠杆倍数，如果超过配置的最大值，将禁止开仓以保护您的资金安全。

## 查看当前杠杆率

系统启动时会在日志中显示当前杠杆倍数：

```
📊 交易所: Binance, 交易对: ETHUSDT, 当前杠杆倍数: 20x, 当前持仓: 0.0000
```

## 杠杆率来源

系统会按以下顺序获取杠杆倍数：

1. **从持仓信息获取**：如果当前交易对已有持仓，从持仓中读取杠杆倍数
2. **从账户信息获取**：如果持仓中没有，从账户的杠杆设置中获取
3. **币安特定方法**：对于币安交易所，会尝试通过特定 API 获取更准确的杠杆信息

## 修改杠杆率的方法

### 方法一：在交易所网站修改（推荐）

杠杆率是在交易所账户中设置的，不是在这个系统中设置的。您需要在交易所网站修改：

#### 币安测试网
1. 访问：https://testnet.binancefuture.com/
2. 登录账户
3. 进入"交易"页面
4. 找到"杠杆"或"Leverage"设置
5. 将杠杆倍数调整为 10x 或更低（推荐 5x-10x）
6. 保存设置

#### 币安主网
1. 访问：https://www.binance.com/
2. 登录账户
3. 进入"合约交易"页面
4. 找到"杠杆"设置
5. 将杠杆倍数调整为 10x 或更低
6. 保存设置

**注意**：
- 修改杠杆后，需要重启本系统才能生效
- 建议使用 5x-10x 杠杆，风险较低
- 20x 杠杆风险很高，不建议使用

### 方法二：修改系统最大杠杆限制（不推荐）

如果您确实需要使用更高的杠杆（如 20x），可以修改系统配置：

#### 步骤

1. 编辑 `config.yaml` 文件
2. 找到 `risk_control` 部分
3. 修改 `max_leverage` 值：

```yaml
risk_control:
  enabled: true
  monitor_symbols: ["BTCUSDT", "ETHUSDT"]
  interval: "1m"
  volume_multiplier: 3.0
  average_window: 20
  recovery_threshold: 3
  max_leverage: 20  # 🔥 修改为 20（或您需要的值，0 表示不限制）
```

4. 保存配置文件
5. 重启系统

#### 配置说明

- **`max_leverage: 10`**（默认）：最大允许 10 倍杠杆
- **`max_leverage: 20`**：最大允许 20 倍杠杆
- **`max_leverage: 0`**：不限制杠杆倍数（**非常危险，不推荐**）

## 杠杆倍数与风险

| 杠杆倍数 | 风险等级 | 说明 |
|---------|---------|------|
| 1x | 极低 | 不使用杠杆，风险最低 |
| 5x | 低 | 适合保守交易者 |
| 10x | 中等 | 系统默认最大值，平衡风险与收益 |
| 20x | 高 | 风险较高，需要严格风控 |
| 50x+ | 极高 | 风险极高，可能导致快速爆仓 |

### 杠杆倍数的影响

**示例**：账户余额 1000 USDT

- **1x 杠杆**：可用资金 = 1000 USDT
- **10x 杠杆**：可用资金 = 10,000 USDT
- **20x 杠杆**：可用资金 = 20,000 USDT

**风险**：
- 杠杆越高，可用资金越多，但风险也越大
- 价格波动 5%，20x 杠杆可能导致 100% 的损失
- 价格波动 10%，20x 杠杆可能导致爆仓

## 常见问题

### Q: 为什么系统显示杠杆倍数是 20x，但我没有设置过？

A: 币安测试网/主网的默认杠杆可能是 20x。您需要在交易所网站手动调整为 10x 或更低。

### Q: 修改杠杆后系统还是报错？

A: 请确保：
1. 在交易所网站成功修改了杠杆倍数
2. 重启了本系统
3. 检查日志确认杠杆倍数已更新

### Q: 可以设置不限制杠杆吗？

A: 可以，但不推荐。设置 `max_leverage: 0` 将不限制杠杆倍数，但这样会失去重要的风险保护。

### Q: 系统默认最大杠杆是多少？

A: 系统默认最大杠杆是 **10x**。这是经过风险评估后的安全值。

### Q: 如何查看交易所账户的当前杠杆设置？

A: 
- **币安测试网**：登录后进入"交易"页面，查看右上角的杠杆显示
- **币安主网**：登录后进入"合约交易"页面，查看杠杆设置

## 推荐配置

### 保守型（推荐新手）
```yaml
risk_control:
  max_leverage: 5  # 最大 5 倍杠杆
```

### 平衡型（推荐大多数用户）
```yaml
risk_control:
  max_leverage: 10  # 最大 10 倍杠杆（默认）
```

### 激进型（不推荐）
```yaml
risk_control:
  max_leverage: 20  # 最大 20 倍杠杆（高风险）
```

## 安全提示

⚠️ **重要提醒**：

1. **杠杆是一把双刃剑**：可以放大收益，也会放大亏损
2. **不要盲目追求高杠杆**：20x 杠杆意味着价格波动 5% 就可能损失全部资金
3. **建议使用 5x-10x 杠杆**：在风险可控的前提下获得合理收益
4. **定期检查杠杆设置**：确保杠杆倍数在您的风险承受范围内
5. **测试网可以随意测试**：在测试网中尝试不同杠杆，了解其影响

## 技术支持

如有问题，请查看：
- 币安测试网文档：https://testnet.binancefuture.com/en/fapi/
- 币安主网文档：https://binance-docs.github.io/apidocs/futures/cn/

